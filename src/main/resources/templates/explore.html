<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Explore Page</title>
    <link th:href="@{/styles/explore.css}" rel="stylesheet">
</head>
<body>

<!--Header-->
<header>
    <nav class="nav">
        <img class="logo" height="100" alt="Logo" src="./images/logo.png" title="Logo">
        <input type="text" placeholder="Search for a park..." id="search" name="search" onkeyup="searchParks()">
        <a th:href="@{/home}">Home</a>&emsp;
        <a th:href="@{/register}">Sign Up</a>&emsp;
        <a th:href="@{/addPark}">Add a Park</a>&emsp;
        <button onclick="location.href='/adminPage'">Administrator</button>
    </nav>
</header>

<div class="top-section">
    <h1 class="h1">
        Explore All of Cardiff's Parks
    </h1>
</div>

<div id="parks-list">
    <table id="parksTable">
        <thead>
        <tr>
            <th>Name</th>
            <th>Location</th>
            <th>Rating</th>
            <th>Amenities</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="park : ${parks}">
            <td>
                <a th:href="@{/park/{parkName}(parkName=${park.name})}"
                   th:text="${park.name}">Park Name</a>
            </td>
            <td th:text="${park.location}">Location</td>
            <td th:text="${park.rating}">Rating</td>
            <td th:text="${park.amenitiesAsString}">Amenities</td>
        </tr>
        </tbody>
    </table>
</div>

<button onclick="sortRatingH2L()">Sort highest to lowest rating</button>
<button onclick="sortRatingL2H()">Sort lowest to highest rating</button>
<button onclick="filterParking()">View parks with parking</button>
<button onclick="filterDogs()">View dog-friendly parks</button>
<button onclick="filterKids()">View kid-friendly parks</button>
<button onclick="showAllParks()">Show All Parks</button>

<script>
    function searchParks() {
        let query = document.getElementById("search").value.toLowerCase();
        let rows = document.querySelectorAll("#parksTable tbody tr");

        rows.forEach(row => {
            const name = row.cells[0].textContent.toLowerCase();
            const location = row.cells[1].textContent.toLowerCase();
            row.style.display = (name.includes(query) || location.includes(query)) ? "" : "none";
        });
    }

    function sortRatingH2L() {
        sortTableByRating(true);
    }

    function sortRatingL2H() {
        sortTableByRating(false);
    }

    function sortTableByRating(descending) {
        let table = document.getElementById("parksTable").getElementsByTagName('tbody')[0];
        let rows = Array.from(table.rows);

        rows.sort((a, b) => {
            let ratingA = parseFloat(a.cells[2].textContent);
            let ratingB = parseFloat(b.cells[2].textContent);
            return descending ? ratingB - ratingA : ratingA - ratingB;
        });

        rows.forEach(row => table.appendChild(row));
    }

    function filterParking() {
        filterTable(3, "Has Parking");
    }

    function filterDogs() {
        filterTable(3, "Allows Dogs");
    }

    function filterKids() {
        filterTable(3, "Kid Friendly");
    }

    function filterTable(columnIndex, filterText) {
        let rows = document.querySelectorAll("#parksTable tbody tr");
        rows.forEach(row => {
            let amenities = row.cells[columnIndex].textContent;
            row.style.display = amenities.includes(filterText) ? "" : "none";
        });
    }

    function showAllParks() {
        let rows = document.querySelectorAll("#parksTable tbody tr");
        rows.forEach(row => {
            row.style.display = "";
        });
    }
</script>

<!--Footer-->
<footer class="footer">
    <h3>About Green Spaces</h3>
    <p>We're a group of outdoor enthusiasts, environmentalists, and city explorers passionate about green spaces!
        With backgrounds in ecology, design, and tech, we are committed to helping people find their next favorite park and meet like-minded park enthusiasts.
        Each review blends expert insights and real experiences to make every visit memorable.</p><br>
    <em><a th:href="@{/register}">Sign up</a> today to join our community!</em><br>
    <a href="">Terms of Service</a><br>
    <a href="">Privacy Policy</a>
</footer>

</body>
</html>
